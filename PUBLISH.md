# è‡ªåŠ¨å‘å¸ƒæŒ‡å—

## æ¦‚è¿°

è¿™ä¸ªé¡¹ç›®é…ç½®äº†å®Œæ•´çš„ CI/CD æµç¨‹ï¼Œå¯ä»¥è‡ªåŠ¨å°†ä»£ç æ¨é€åˆ° GitHub åå‘å¸ƒæ–°ç‰ˆæœ¬åˆ° npmã€‚

## ğŸš€ å‘å¸ƒæµç¨‹

### æ–¹æ³• 1: ä½¿ç”¨å‘å¸ƒè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å‘å¸ƒ patch ç‰ˆæœ¬ (1.0.0 -> 1.0.1)
npm run release:patch

# å‘å¸ƒ minor ç‰ˆæœ¬ (1.0.0 -> 1.1.0)  
npm run release:minor

# å‘å¸ƒ major ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
npm run release:major

# æˆ–è€…ç›´æ¥ä½¿ç”¨è„šæœ¬
./scripts/release.sh patch
```

å‘å¸ƒè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. âœ… æ£€æŸ¥å½“å‰åˆ†æ”¯æ˜¯å¦ä¸º main
2. âœ… æ£€æŸ¥å·¥ä½œç›®å½•æ˜¯å¦å¹²å‡€
3. âœ… æ‹‰å–æœ€æ–°ä»£ç 
4. âœ… å®‰è£…ä¾èµ–å¹¶æ„å»º
5. âœ… æµ‹è¯•æ„å»ºç»“æœ
6. âœ… æ›´æ–°ç‰ˆæœ¬å·
7. âœ… åˆ›å»ºæäº¤å’Œæ ‡ç­¾
8. âœ… æ¨é€åˆ° GitHub
9. âœ… è§¦å‘è‡ªåŠ¨å‘å¸ƒ

### æ–¹æ³• 2: æ‰‹åŠ¨åˆ›å»ºæ ‡ç­¾

```bash
# æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬
npm version patch  # æˆ– minor/major

# æ¨é€æ ‡ç­¾
git push origin main --tags
```

### æ–¹æ³• 3: GitHub æ‰‹åŠ¨è§¦å‘

1. è®¿é—® GitHub ä»“åº“çš„ Actions é¡µé¢
2. é€‰æ‹© "Publish to NPM" å·¥ä½œæµ
3. ç‚¹å‡» "Run workflow"
4. é€‰æ‹©ç‰ˆæœ¬ç±»å‹ (patch/minor/major)
5. ç‚¹å‡» "Run workflow"

## ğŸ”§ è®¾ç½®è¯´æ˜

### å¿…éœ€çš„ GitHub Secrets

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ Secretsï¼š

1. **NPM_TOKEN**: NPM å‘å¸ƒä»¤ç‰Œ
   - è®¿é—® https://www.npmjs.com/settings/tokens
   - åˆ›å»ºæ–°çš„ "Automation" ç±»å‹ä»¤ç‰Œ
   - å¤åˆ¶ä»¤ç‰Œåˆ° GitHub Secrets

### NPM ä»¤ç‰Œåˆ›å»ºæ­¥éª¤

1. ç™»å½• npm ç½‘ç«™
2. ç‚¹å‡»å¤´åƒ â†’ "Access Tokens"
3. ç‚¹å‡» "Generate New Token"
4. é€‰æ‹© "Automation" ç±»å‹
5. å¤åˆ¶ç”Ÿæˆçš„ä»¤ç‰Œ
6. åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä¸º Secret

## ğŸ“‹ å·¥ä½œæµè¯´æ˜

### CI å·¥ä½œæµ (`.github/workflows/ci.yml`)

**è§¦å‘æ¡ä»¶**: 
- æ¨é€åˆ° `main` æˆ– `develop` åˆ†æ”¯
- åˆ›å»º Pull Request åˆ° `main` åˆ†æ”¯

**åŠŸèƒ½**:
- âœ… åœ¨ Node.js 18.x å’Œ 20.x ä¸Šæµ‹è¯•
- âœ… TypeScript ç¼–è¯‘æ£€æŸ¥
- âœ… æœåŠ¡å™¨å¯åŠ¨æµ‹è¯•
- âœ… npx åŠŸèƒ½æµ‹è¯•
- âœ… åŒ…ç»“æ„æ£€æŸ¥

### å‘å¸ƒå·¥ä½œæµ (`.github/workflows/publish.yml`)

**è§¦å‘æ¡ä»¶**:
- æ¨é€ä»¥ `v` å¼€å¤´çš„æ ‡ç­¾ (å¦‚ `v1.0.1`)
- æ‰‹åŠ¨è§¦å‘ (workflow_dispatch)

**åŠŸèƒ½**:
- âœ… è¿è¡Œå®Œæ•´æµ‹è¯•
- âœ… æ„å»ºé¡¹ç›®
- âœ… å‘å¸ƒåˆ° npm
- âœ… åˆ›å»º GitHub Release
- âœ… è‡ªåŠ¨ç”Ÿæˆå‘å¸ƒè¯´æ˜

## ğŸ“Š å‘å¸ƒçŠ¶æ€ç›‘æ§

### æ£€æŸ¥å‘å¸ƒçŠ¶æ€

1. **GitHub Actions**: https://github.com/latel/mcp-ip-geolocator-npx/actions
2. **npm åŒ…é¡µé¢**: https://www.npmjs.com/package/mcp-ip-geolocator-npx
3. **GitHub Releases**: https://github.com/latel/mcp-ip-geolocator-npx/releases

### å¸¸ç”¨ç›‘æ§å‘½ä»¤

```bash
# æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬
npm view mcp-ip-geolocator-npx version

# æ£€æŸ¥åŒ…ä¿¡æ¯
npm info mcp-ip-geolocator-npx

# æµ‹è¯•æœ€æ–°å‘å¸ƒç‰ˆæœ¬
npx mcp-ip-geolocator-npx@latest
```

## ğŸ” æ•…éšœæ’é™¤

### å‘å¸ƒå¤±è´¥å¸¸è§åŸå› 

1. **NPM_TOKEN æ— æ•ˆæˆ–è¿‡æœŸ**
   - é‡æ–°ç”Ÿæˆ npm ä»¤ç‰Œ
   - æ›´æ–° GitHub Secrets

2. **ç‰ˆæœ¬å·å†²çª**
   - npm ä¸Šå·²å­˜åœ¨ç›¸åŒç‰ˆæœ¬
   - éœ€è¦æ›´æ–°ç‰ˆæœ¬å·

3. **æ„å»ºå¤±è´¥**
   - æ£€æŸ¥ TypeScript ç¼–è¯‘é”™è¯¯
   - æœ¬åœ°è¿è¡Œ `npm run build` æµ‹è¯•

4. **æµ‹è¯•å¤±è´¥**
   - æœåŠ¡å™¨å¯åŠ¨é—®é¢˜
   - ä¾èµ–å®‰è£…é—®é¢˜

### è°ƒè¯•æ­¥éª¤

```bash
# æœ¬åœ°æµ‹è¯•å®Œæ•´æµç¨‹
npm ci
npm run build
npm pack
npx ./mcp-ip-geolocator-npx-*.tgz

# æ£€æŸ¥åŒ…å†…å®¹
tar -tzf mcp-ip-geolocator-npx-*.tgz
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **åœ¨å‘å¸ƒå‰**:
   - ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
   - æ›´æ–° README å’Œæ–‡æ¡£
   - æ£€æŸ¥ CHANGELOG

2. **ç‰ˆæœ¬ç®¡ç†**:
   - patch: ä¿®å¤ bug
   - minor: æ–°åŠŸèƒ½ï¼Œå‘åå…¼å®¹
   - major: ç ´åæ€§æ›´æ”¹

3. **å‘å¸ƒèŠ‚å¥**:
   - å°è€Œé¢‘ç¹çš„å‘å¸ƒ
   - åŠæ—¶ä¿®å¤é—®é¢˜
   - ä¿æŒç¨³å®šçš„ API

## ğŸ“ å‘å¸ƒæ¸…å•

- [ ] ä»£ç å·²åˆå¹¶åˆ° main åˆ†æ”¯
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] CHANGELOG å·²æ›´æ–°ï¼ˆå¦‚æœ‰ï¼‰
- [ ] ç‰ˆæœ¬å·åˆé€‚
- [ ] NPM_TOKEN æœ‰æ•ˆ
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡

å®Œæˆæ¸…å•åï¼Œè¿è¡Œ `npm run release:patch` å³å¯å¼€å§‹è‡ªåŠ¨å‘å¸ƒæµç¨‹ï¼
